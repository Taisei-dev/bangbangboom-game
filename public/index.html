<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Bang player</title>
</head>
<body>
    <style>
        body{
            margin:0;
        }
    </style>
    <div id="app"></div>
    <script src="./bangbangboom-game.js"></script>
    <script src="./gunzip.min.js"></script>
    <script>
        async function loadMap() {
            return fetch('/assets/data')
                    .then(res=>res.arrayBuffer())
                    .then(buffer=>{return new Zlib.Gunzip(new Uint8Array(buffer))})
                    .then(gunzip=>{return gunzip.decompress()})
                    .then(uint8Arr=>{return JSON.parse(new TextDecoder().decode(uint8Arr))})
        }
        let GameConfig = {
          judgeOffset: 0,
          visualOffset: 0,
          speed: 10.5,
          resolution: 1,
          noteScale: 1,
          barOpacity: 1,
          backgroundDim: 0.5,
          effectVolume: 1,
          showSimLine: true,
          laneEffect: false,
          mirror: false,
          beatNote: true,
          debug:false
        }
        GameLoadConfig = {
          mapContent: loadMap,
          musicSrc: "/assets/0001_01.mp3",
          loadingBackgroundSrc: "/assets/loadBG.png",
          backgroundSrc: "/assets/liveBG.png",
          coverSrc: "/assets/cover.png",
          skin: "/assets/sekai",
          songName: "Tell Your World - Master"
        }
      
        function GameStart() {
          const div = document.getElementById("app")
          const canvas = document.createElement("canvas")
          canvas.width=1272
          canvas.height=1080
          canvas.style.height = "100%"
          canvas.style.width = "100%"
          div.appendChild(canvas)
      
          const game = new BangGame.Game(canvas, GameConfig, GameLoadConfig)
          game.start()
          game.ondestroyed = () => {
            div.removeChild(canvas)
          }
        }
        GameStart()
      </script>
</body>
</html>